:PROPERTIES:
:ID:       ba103e30-a7e4-4332-b9c0-b3b07a16eb40
:ROAM_ALIASES: "Gram-Schmidt process"
:END:
#+title: QR decomposition
#+filetags: :LinearAlgebra:MatrixFactorization:
#+startup: latexpreview

* General case

The QR decomposition is the factorization of a matrix into a product of $Q$ and $R$, where
 - $Q$ is orthonormal: $Q^{-1} = Q^T$
 - $R$ is upper triangular

If $A$ has $n$ linearly independant columns, the first $n$ columns of
$Q$ form an orthonormal basis of $\mathrm{span}(A)$, the vector space
generated by the columns of $A$.

* Rectangular matrices
  Let us assume that $A\in\mathbb{R}^{n \times m}$, with $n \geq m$
  (more rows than cols). $A=QR$ with $Q \in \mathbb{R}^{n\times n}$
  unitary and $R\in\mathbb{R}^{n \times m}$ upper triangular.

  We can however partition this factorization as following:

  \begin{equation}
    A = QR = Q \begin{bmatrix} R_1 \\ 0 \end{bmatrix} = \begin{bmatrix} Q_1 & Q_2 \end{bmatrix} \begin{bmatrix} R_1 \\ 0 \end{bmatrix} = Q_1R_1
  \end{equation}

* Gram-Schmidt Process

** Classical algorithm
   The Gram-Schmidt process is equivalent to computing the QR
   decomposition of the matrix whose columns are the vectors to be
   processed.

   Let $A = [a_1,\dots, a_n]$, and define the inner product as $\langle
   v, w \rangle = v^Tw$, and the projection of $a$ on the vector space generated by $u$ as
   $\mathrm{proj}_u(a) = \frac{\langle u, a\rangle}{\|u\|^2}u$
   \begin{align}
     u_1 = a_1 \quad & \quad e_1 = u_1 / \|u_1\| \\
     u_2 = a_2 - \mathrm{proj}_{u_1}(a_2)  \quad & \quad e_2 = u_2 / \|u_2\| \\
 \dots \\
     u_k = a_k - \sum_{j=1}^{k-1} \mathrm{proj}_{u_j}(a_k) \quad & \quad e_k = u_k / \|u_k\|
   \end{align}


   Finally, we have $Q = [e_1, \dots, e_n]$ and
   \begin{equation}
   R = \begin{bmatrix}\langle e_1, a_1 \rangle & \langle e_1, a_2 \rangle & \dots & \langle e_1, a_n \rangle\\
 0 &  \langle e_2, a_2 \rangle & \dots &\langle e_2, a_n \rangle \\
 \vdots
 & & &\langle e_n, a_n\rangle
   \end{bmatrix}
   \end{equation}

   
** Modified Gram Schmidt
